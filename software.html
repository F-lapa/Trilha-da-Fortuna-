<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trilha da Fortuna</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" integrity="sha512-z3gLpd7yknf1YoNbCzqRKc4qyor8gaKU1qmn+CShxbuBusANI9QpRohGBreCFkKxLhei6S9CQXFEbbKuqLg0DA==" crossorigin="anonymous">
    <style>
        :root {
            --primary-color: #1e3a8a;
            --secondary-color: #10b981;
            --accent-color: #f59e0b;
            --background-color: #f9fafb;
            --text-color: #111827;
            --card-bg: #ffffff;
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            --border-radius: 0.75rem;
        }

        body.dark-theme {
            --primary-color: #1e40af;
            --secondary-color: #34d399;
            --accent-color: #facc15;
            --background-color: #111827;
            --text-color: #e5e7eb;
            --card-bg: #1f2937;
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--background-color);
            color: var(--text-color);
            line-height: 1.6;
            transition: background 0.3s ease, color 0.3s ease;
        }

        header {
            background: var(--card-bg);
            color: var(--text-color);
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        header h1 {
            font-family: 'Roboto', sans-serif;
            font-size: 1.8rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        header h1 i {
            color: var(--secondary-color);
        }

        #themeToggle {
            background: none;
            border: none;
            color: var(--text-color);
            font-size: 1.5rem;
            cursor: pointer;
        }

        #logoutLink {
            color: var(--text-color);
            text-decoration: none;
            font-weight: 500;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
        }

        #logoutLink:hover {
            background: var(--secondary-color);
            color: #fff;
        }

        .container {
            max-width: 1200px;
            margin: 2rem auto;
            padding: 0 1rem;
        }

        .home-section {
            padding: 2rem;
            text-align: center;
            background: var(--card-bg);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
        }

        .home-section h2 {
            font-family: 'Roboto', sans-serif;
            font-size: 2rem;
            color: var(--primary-color);
            margin-bottom: 1rem;
        }

        .home-section p {
            font-size: 1.1rem;
            max-width: 800px;
            margin: 0 auto 2rem;
            color: #6b7280;
        }

        .home-section .feature-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
        }

        .home-section .feature-card {
            background: var(--card-bg);
            color: var(--text-color);
            padding: 1.5rem;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
        }

        .home-section .feature-card i {
            font-size: 2rem;
            color: var(--secondary-color);
            margin-bottom: 1rem;
        }

        .home-section .feature-card h3 {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
            color: var(--primary-color);
        }

        .progress-chart {
            max-width: 600px;
            margin: 2rem auto;
        }

        .nav-tabs {
            background: var(--card-bg);
            border-radius: var(--border-radius);
            padding: 0.5rem;
            display: flex;
            gap: 0.5rem;
            border-bottom: none;
        }

        .nav-tabs .nav-link {
            color: var(--text-color);
            font-weight: 500;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .nav-tabs .nav-link.active {
            background: var(--secondary-color);
            color: #fff;
        }

        .nav-tabs .nav-link:hover {
            background: rgba(0, 0, 0, 0.05);
        }

        .tab-content {
            background: var(--card-bg);
            padding: 2rem;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
        }

        .table {
            border-radius: var(--border-radius);
            overflow: hidden;
            background: var(--card-bg);
        }

        .table th {
            background: var(--primary-color);
            color: #fff;
        }

        .list-group-item {
            border-radius: 0.5rem;
            margin-bottom: 0.5rem;
            padding: 1rem;
            background: var(--card-bg);
        }

        .modal-content {
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            background: var(--card-bg);
        }

        .modal-header {
            background: var(--primary-color);
            color: #fff;
            border-radius: var(--border-radius) var(--border-radius) 0 0;
        }

        .modal-body {
            background: var(--card-bg);
            padding: 1.5rem;
            max-height: 60vh;
            overflow-y: auto;
        }

        .modal-header .btn-close {
            filter: brightness(100%) invert(100%);
        }

        .question {
            background: var(--card-bg);
            border: 1px solid #e5e7eb;
            padding: 1.5rem;
            margin-bottom: 1rem;
            border-radius: 0.5rem;
        }

        .question p {
            font-weight: 500;
            color: var(--primary-color);
            margin-bottom: 1rem;
        }

        footer {
            background: var(--primary-color);
            color: #fff;
            text-align: center;
            padding: 1.5rem;
            margin-top: 2rem;
        }

        .form-control {
            border-radius: 0.5rem;
            border: 1px solid #d1d5db;
            padding: 0.75rem;
        }

        .form-control:focus {
            border-color: var(--secondary-color);
            outline: none;
        }

        .btn-primary {
            background: var(--secondary-color);
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            color: #fff;
        }

        .success-message {
            color: var(--secondary-color);
            font-size: 0.875rem;
            margin-top: 0.5rem;
            display: none;
        }

        .error-message {
            color: #dc3545;
            font-size: 0.875rem;
            margin-top: 0.5rem;
            display: none;
        }

        .error-message#corretaError {
            display: none;
            color: #dc3545;
            font-size: 0.875rem;
            margin-top: 0.25rem;
        }

        .hidden {
            display: none;
        }

        .feed-container {
            max-width: 800px;
            margin: 2rem auto;
        }

        .feed-post {
            background: var(--card-bg);
            padding: 1.5rem;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            margin-bottom: 1.5rem;
        }

        .feed-post-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .feed-post-header h5 {
            margin: 0;
            font-size: 1.2rem;
            color: var(--primary-color);
        }

        .feed-post-header small {
            color: #6b7280;
        }

        .feed-post-menu {
            position: relative;
        }

        .feed-post-menu-btn {
            background: none;
            border: none;
            color: var(--text-color);
            font-size: 1.2rem;
            cursor: pointer;
        }

        .feed-post-menu-content {
            display: none;
            position: absolute;
            right: 0;
            top: 100%;
            background: var(--card-bg);
            box-shadow: var(--shadow);
            border-radius: 0.5rem;
            z-index: 10;
        }

        .feed-post-menu-content.show {
            display: block;
        }

        .feed-post-menu-content button {
            display: block;
            width: 100%;
            padding: 0.5rem 1rem;
            background: none;
            border: none;
            text-align: left;
            color: #dc3545;
            cursor: pointer;
        }

        .btn-danger {
            background: #dc3545;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            color: #fff;
        }

        .feed-actions {
            display: flex;
            gap: 1rem;
            margin-bottom: 0.5rem;
        }

        .feed-action-btn {
            background: none;
            border: none;
            color: var(--text-color);
            font-size: 0.85rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        .feed-action-btn.liked {
            color: var(--secondary-color);
        }

        .comment-section {
            margin-top: 0.3rem;
        }

        .comment-form {
            margin-bottom: 0.3rem;
        }

        .comment-form .form-control {
            font-size: 0.8rem;
            padding: 0.4rem;
            height: 2rem;
        }

        .comment-form .btn-primary {
            padding: 0.3rem 0.6rem;
            font-size: 0.8rem;
        }

        .comments {
            margin-top: 0.3rem;
        }

        .comment {
            background: var(--card-bg);
            padding: 0.5rem;
            margin-bottom: 0.3rem;
            border-radius: 0.3rem;
            border-left: 2px solid var(--secondary-color);
        }

        .comment-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.2rem;
            font-size: 0.85rem;
        }

        .comment-header h6 {
            margin: 0;
            font-size: 0.85rem;
            color: var(--primary-color);
        }

        .comment-header small {
            color: #6b7280;
            font-size: 0.75rem;
        }

        .comment-body {
            font-size: 0.8rem;
            color: var(--text-color);
            margin-bottom: 0.2rem;
        }

        .comment-actions {
            display: flex;
            gap: 0.5rem;
            margin-top: 0.2rem;
        }

        .btn-reply {
            background: none;
            border: none;
            color: var(--primary-color);
            font-size: 0.75rem;
            cursor: pointer;
            padding: 0;
        }

        .reply-form {
            margin-top: 0.3rem;
            margin-left: 0.75rem;
            display: none;
        }

        .reply-form.show {
            display: block;
        }

        .reply-form .form-control {
            font-size: 0.75rem;
            padding: 0.3rem;
            height: 1.8rem;
        }

        .reply-form .btn-primary {
            padding: 0.2rem 0.5rem;
            font-size: 0.75rem;
        }

        .replies {
            margin-left: 0.75rem;
            margin-top: 0.3rem;
        }

        .replies .comment {
            padding: 0.4rem;
            margin-bottom: 0.2rem;
        }

        .replies .comment-header {
            font-size: 0.8rem;
        }

        .replies .comment-body {
            font-size: 0.75rem;
        }
    </style>
</head>
<body>
    <header id="header">
        <h1><i class="fas fa-coins"></i> Trilha da Fortuna</h1>
        <div>
            <button id="themeToggle" title="Alternar Tema"><i class="fas fa-moon"></i></button>
            <a href="index.html" id="logoutLink">Sair</a>
        </div>
    </header>

    <div class="container">
        <section class="content-section" id="contentSection">
            <ul class="nav nav-tabs mb-0" id="navTabs" role="tablist">
                <li class="nav-item">
                    <a class="nav-link active" id="homeTab" data-bs-toggle="tab" href="#home" role="tab"> Home</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" id="provasTab" data-bs-toggle="tab" href="#provas" role="tab"> Provas</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" id="rankingTab" data-bs-toggle="tab" href="#ranking" role="tab"> Ranking</a>
                </li>
                <li class="nav-item" id="comprovanteTabItem">
                    <a class="nav-link" id="comprovanteTabLink" data-bs-toggle="tab" href="#comprovante" role="tab"> Enviar Comprovante</a>
                </li>
                <li class="nav-item hidden" id="adminTabItem">
                    <a class="nav-link" id="adminTabLink" data-bs-toggle="tab" href="#administrador" role="tab"> Administrador</a>
                </li>
                <li class="nav-item hidden" id="investimentosTabItem">
                    <a class="nav-link" id="investimentosTabLink" data-bs-toggle="tab" href="#investimentos" role="tab"> Investimentos</a>
                </li>
            </ul>

            <div class="tab-content">
                <section class="tab-pane fade show active" id="home" role="tabpanel">
                    <div class="home-section">
                        <h2>Bem-vindo à Trilha da Fortuna!</h2>
                        <p>Explore sua jornada financeira com aprendizado e competição.</p>
                        <div class="progress-chart">
                            <canvas id="progressChart"></canvas>
                        </div>
                        <div class="feature-cards">
                            <article class="feature-card">
                                <i class="fas fa-file-alt"></i>
                                <h3>Provas</h3>
                                <p>Teste seus conhecimentos e ganhe pontos.</p>
                            </article>
                            <article class="feature-card">
                                <i class="fas fa-trophy"></i>
                                <h3>Ranking</h3>
                                <p>Compare sua pontuação e suba no ranking.</p>
                            </article>
                            <article class="feature-card">
                                <i class="fas fa-file-invoice-dollar"></i>
                                <h3>Comprovantes</h3>
                                <p>Envie comprovantes de investimentos.</p>
                            </article>
                        </div>
                        <div id="feedSection" class="mt-4">
                            <h3>Feed de Recados</h3>
                            <div id="feedFormContainer" class="mb-4 hidden">
                                <form id="feedForm" novalidate>
                                    <div class="mb-3">
                                        <label for="feedMessage" class="form-label">Novo Recado</label>
                                        <textarea id="feedMessage" class="form-control" placeholder="Digite seu recado" required></textarea>
                                    </div>
                                    <button type="submit" class="btn btn-primary">Postar</button>
                                    <div class="success-message" id="feedSuccess">Recado postado com sucesso!</div>
                                    <div class="error-message" id="feedError">Por favor, insira uma mensagem válida.</div>
                                </form>
                            </div>
                            <div id="feedContainer" class="feed-container"></div>
                        </div>
                    </div>
                </section>

                <section class="tab-pane fade" id="provas" role="tabpanel">
                    <h2 class="mb-4"> Provas Disponíveis</h2>
                    <ul class="list-group" id="listaProvas"></ul>
                </section>

                <section class="tab-pane fade" id="ranking" role="tabpanel">
                    <h2 class="mb-4"> Ranking de Usuários</h2>
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>Posição</th>
                                <th>Nome</th>
                                <th>Pontos</th>
                                <th>Ação</th>
                            </tr>
                        </thead>
                        <tbody id="rankingBody"></tbody>
                    </table>
                </section>

                <section class="tab-pane fade" id="comprovante" role="tabpanel">
                    <h2 class="mb-4"> Enviar Comprovante</h2>
                    <div class="card">
                        <div class="card-body">
                            <form id="comprovanteForm">
                                <div class="mb-3">
                                    <label for="comprovanteArquivo" class="form-label">Selecione o comprovante</label>
                                    <input type="file" id="comprovanteArquivo" class="form-control" accept=".jpg,.jpeg,.png,.pdf" required>
                                </div>
                                <button type="submit" class="btn btn-primary">Enviar</button>
                                <div class="success-message" id="comprovanteSuccess">Comprovante enviado!</div>
                            </form>
                        </div>
                    </div>
                </section>

                <section class="tab-pane fade" id="administrador" role="tabpanel">
                    <h2 class="mb-4"> Gerenciamento</h2>
                    <div class="card mb-4">
                        <div class="card-body">
                            <h5>Criar Prova</h5>
                            <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#novaProvaModal">Criar Prova</button>
                        </div>
                    </div>
                    <div class="card">
                        <div class="card-body">
                            <h5>Cadastrar Usuário</h5>
                            <form id="novoUsuarioForm">
                                <div class="mb-3">
                                    <label for="novoUsername" class="form-label">Nome de usuário</label>
                                    <input type="text" id="novoUsername" class="form-control" required>
                                </div>
                                <div class="mb-3">
                                    <label for="novoPassword" class="form-label">Senha</label>
                                    <input type="password" id="novoPassword" class="form-control" required>
                                </div>
                                <div class="mb-3">
                                    <label for="nomeUsuario" class="form-label">Nome</label>
                                    <input type="text" id="nomeUsuario" class="form-control" required>
                                </div>
                                <button type="submit" class="btn btn-primary">Cadastrar</button>
                            </form>
                        </div>
                    </div>
                </section>

                <section class="tab-pane fade" id="investimentos" role="tabpanel">
                    <h2 class="mb-4"> Investimentos Recebidos</h2>
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>Usuário</th>
                                <th>Data de Envio</th>
                                <th>Status</th>
                                <th>Ação</th>
                            </tr>
                        </thead>
                        <tbody id="investimentosBody"></tbody>
                    </table>
                </section>
            </div>
        </section>
    </div>

    <div class="modal fade" id="novaProvaModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="novaProvaModalLabel">Criar Nova Prova</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="novaProvaForm">
                        <div class="mb-3">
                            <label for="tituloProva" class="form-label">Título da Prova</label>
                            <input type="text" id="tituloProva" class="form-control" required>
                        </div>
                        <div id="perguntasLista" class="mb-3"></div>
                        <div class="d-flex gap-2">
                            <button type="button" class="btn btn-secondary" data-bs-toggle="modal" data-bs-target="#novaPerguntaModal">Adicionar Pergunta</button>
                            <button type="submit" class="btn btn-primary">Enviar Prova</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="novaPerguntaModal" tabindex="-1">
        <div class="modal-dialog modal-md">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="novaPerguntaModalLabel">Pergunta 1</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="novaPerguntaForm">
                        <div class="mb-3">
                            <label for="perguntaTexto" class="form-label">Pergunta</label>
                            <textarea class="form-control" id="perguntaTexto" required></textarea>
                        </div>
                        <div class="mb-3">
                            <label for="opcaoA" class="form-label">Resposta A</label>
                            <input type="text" class="form-control" id="opcaoA" required>
                        </div>
                        <div class="mb-3">
                            <label for="opcaoB" class="form-label">Resposta B</label>
                            <input type="text" class="form-control" id="opcaoB" required>
                        </div>
                        <div class="mb-3">
                            <label for="opcaoC" class="form-label">Resposta C</label>
                            <input type="text" class="form-control" id="opcaoC" required>
                        </div>
                        <div class="mb-3">
                            <label for="opcaoD" class="form-label">Resposta D</label>
                            <input type="text" class="form-control" id="opcaoD" required>
                        </div>
                        <div class="mb-3">
                            <label for="correta" class="form-label">Resposta correta (a, b, c, d)</label>
                            <input type="text" class="form-control" id="correta" maxlength="1" required>
                            <div class="error-message" id="corretaError">Apenas as letras a, b, c ou d são permitidas.</div>
                        </div>
                        <div class="d-flex gap-2">
                            <button type="submit" class="btn btn-primary">Próxima Pergunta</button>
                            <button type="button" class="btn btn-success" onclick="enviarProva()">Enviar Prova</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="provaModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="provaModalLabel"> Prova</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="provaForm">
                        <div id="perguntaContainer"></div>
                        <div class="d-flex justify-content-between mt-3">
                            <button type="button" id="btnAnterior" class="btn btn-secondary hidden">Pergunta Anterior</button>
                            <button type="button" id="btnProxima" class="btn btn-primary">Próxima Pergunta</button>
                            <button type="button" id="btnEnviar" class="btn btn-primary hidden">Enviar Prova</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="confirmacaoEnvioModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="confirmacaoEnvioModalLabel">Confirmar Envio</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <p>Tem certeza que deseja enviar a prova? Você não poderá alterar suas respostas após o envio.</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-primary" id="confirmarEnvioBtn">Enviar</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="confirmacaoExclusaoProvaModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="confirmacaoExclusaoProvaModalLabel">Confirmação de Exclusão</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <p>Tem certeza que deseja excluir a prova <strong id="tituloProvaExclusao"></strong>?</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-danger" id="confirmarExclusaoProvaBtn">Excluir</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="resultadoModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="resultadoModalLabel"> Resultado</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <p id="resultadoTexto"></p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" data-bs-dismiss="modal">Fechar</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="sucessoModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="sucessoModalLabel"> Sucesso</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <p id="sucessoTexto">Operação realizada com sucesso!</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" id="sucessoOkButton">OK</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="comprovanteModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="comprovanteModalLabel"> Visualizar Comprovante</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <p id="comprovanteInfo"></p>
                    <div id="comprovanteVisualizacao"></div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fechar</button>
                    <button type="button" class="btn btn-primary" id="verificarComprovanteBtn">OK</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="confirmacaoExclusaoModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="confirmacaoExclusaoModalLabel"> Confirmação de Exclusão</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <p>Tem certeza que deseja remover o usuário <strong id="nomeUsuarioExclusao"></strong>?</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-danger" id="confirmarExclusaoBtn">Remover</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="curtidasModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="curtidasModalLabel">Usuários que Curtiram</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <ul id="curtidasLista" class="list-group"></ul>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" data-bs-dismiss="modal">Fechar</button>
                </div>
            </div>
        </div>
    </div>

    <footer id="footer">
        <p>© 2025 Trilha da Fortuna. Todos os direitos reservados.</p>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js" crossorigin="anonymous"></script>
    <script>
        let usuarios = [];
        let provas = [];
        let comprovantes = [];
        let respostas = {};
        let feeds = [];
        let perguntasTemp = [];

        const usuarioLogado = JSON.parse(localStorage.getItem('usuarioLogado'));
        if (!usuarioLogado) {
            window.location.href = 'index.html';
        }

        function carregarDados() {
            const usuariosSalvos = localStorage.getItem('usuarios');
            const provasSalvas = localStorage.getItem('provas');
            const comprovantesSalvos = localStorage.getItem('comprovantes');
            const respostasSalvas = localStorage.getItem('respostas');
            const feedsSalvos = localStorage.getItem('feeds');

            let usuarios = usuariosSalvos ? JSON.parse(usuariosSalvos) : [
                { username: "admin123", password: "admin123", nome: "Administrador", isAdmin: true, pontos: 0 },
                { username: "user1", password: "user123", nome: "João Silva", isAdmin: false, pontos: 100 },
                { username: "user2", password: "user123", nome: "Maria Oliveira", isAdmin: false, pontos: 50 }
            ];

            const adminUser = usuarios.find(u => u.username === "admin123");
            if (adminUser) {
                adminUser.isAdmin = true;
            } else {
                usuarios.push({ username: "admin123", password: "admin123", nome: "Administrador", isAdmin: true, pontos: 0 });
            }

            let feeds = feedsSalvos ? JSON.parse(feedsSalvos) : [];
            feeds = feeds.map(f => ({
                ...f,
                curtidas: Array.isArray(f.curtidas) ? f.curtidas : [],
                comentarios: Array.isArray(f.comentarios) ? f.comentarios.map(c => ({
                    ...c,
                    curtidas: Array.isArray(c.curtidas) ? c.curtidas : [],
                    respostas: Array.isArray(c.respostas) ? c.respostas : []
                })) : []
            }));

            return {
                usuarios,
                provas: provasSalvas ? JSON.parse(provasSalvas) : [],
                comprovantes: comprovantesSalvos ? JSON.parse(comprovantesSalvos) : [],
                respostas: respostasSalvas ? JSON.parse(respostasSalvas) : {},
                feeds
            };
        }

        function salvarDados() {
            localStorage.setItem('usuarios', JSON.stringify(usuarios));
            localStorage.setItem('provas', JSON.stringify(provas));
            localStorage.setItem('comprovantes', JSON.stringify(comprovantes));
            localStorage.setItem('respostas', JSON.stringify(respostas));
            localStorage.setItem('feeds', JSON.stringify(feeds));
        }

        document.addEventListener('DOMContentLoaded', () => {
            const dados = carregarDados();
            usuarios = dados.usuarios;
            provas = dados.provas;
            comprovantes = dados.comprovantes;
            respostas = dados.respostas;
            feeds = dados.feeds;

            ajustarAbas();
            atualizarProvas();
            atualizarRanking();
            atualizarInvestimentos();
            inicializarGrafico();
            configurarFeed();

            document.getElementById('correta').addEventListener('input', (e) => {
                const input = e.target;
                const value = input.value.toLowerCase();
                const errorMessage = document.getElementById('corretaError');

                if (value && !['a', 'b', 'c', 'd'].includes(value)) {
                    input.value = '';
                    errorMessage.style.display = 'block';
                    setTimeout(() => errorMessage.style.display = 'none', 3000);
                } else {
                    errorMessage.style.display = 'none';
                }
            });
        });

        function ajustarAbas() {
            const comprovanteTabItem = document.getElementById('comprovanteTabItem');
            const adminTabItem = document.getElementById('adminTabItem');
            const investimentosTabItem = document.getElementById('investimentosTabItem');
            const feedFormContainer = document.getElementById('feedFormContainer');

            if (usuarioLogado.isAdmin) {
                comprovanteTabItem.classList.add('hidden');
                adminTabItem.classList.remove('hidden');
                investimentosTabItem.classList.remove('hidden');
                feedFormContainer.classList.remove('hidden');
            } else {
                comprovanteTabItem.classList.remove('hidden');
                adminTabItem.classList.add('hidden');
                investimentosTabItem.classList.add('hidden');
                feedFormContainer.classList.add('hidden');
            }
        }

        function inicializarGrafico() {
            if (typeof Chart === 'undefined') {
                console.error('Chart.js não foi carregado corretamente.');
                return;
            }
            const ctx = document.getElementById('progressChart').getContext('2d');
            const usuario = usuarios.find(u => u.username === usuarioLogado.username);
            const pontos = usuario ? usuario.pontos : 0;
            new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Pontos Obtidos', 'Restantes'],
                    datasets: [{
                        data: [pontos, 500 - pontos],
                        backgroundColor: ['#10b981', '#e5e7eb'],
                        borderWidth: 0
                    }]
                },
                options: {
                    cutout: '70%',
                    plugins: { legend: { display: false } }
                }
            });
        }

        document.getElementById('themeToggle').addEventListener('click', () => {
            document.body.classList.toggle('dark-theme');
            const isDark = document.body.classList.contains('dark-theme');
            document.getElementById('themeToggle').innerHTML = `<i class="fas fa-${isDark ? 'sun' : 'moon'}"></i>`;
            localStorage.setItem('theme', isDark ? 'dark' : 'light');
        });

        if (localStorage.getItem('theme') === 'dark') {
            document.body.classList.add('dark-theme');
            document.getElementById('themeToggle').innerHTML = '<i class="fas fa-sun"></i>';
        }

        document.getElementById('novaPerguntaForm').addEventListener('submit', (e) => {
            e.preventDefault();
            const texto = document.getElementById('perguntaTexto').value.trim();
            const opcaoA = document.getElementById('opcaoA').value.trim();
            const opcaoB = document.getElementById('opcaoB').value.trim();
            const opcaoC = document.getElementById('opcaoC').value.trim();
            const opcaoD = document.getElementById('opcaoD').value.trim();
            const correta = document.getElementById('correta').value.trim().toLowerCase();

            if (!texto || !opcaoA || !opcaoB || !opcaoC || !opcaoD || !['a', 'b', 'c', 'd'].includes(correta)) {
                alert('Por favor, preencha todos os campos corretamente. A resposta correta deve ser a, b, c ou d.');
                return;
            }

            perguntasTemp.push({
                texto,
                opcoes: { a: opcaoA, b: opcaoB, c: opcaoC, d: opcaoD },
                correta
            });

            atualizarListaPerguntas();
            document.getElementById('novaPerguntaForm').reset();
            document.getElementById('novaPerguntaModalLabel').textContent = `Pergunta ${perguntasTemp.length + 1}`;
        });

        function enviarProva() {
            const titulo = document.getElementById('tituloProva').value.trim();
            if (!titulo || perguntasTemp.length === 0) {
                alert('Por favor, insira um título e pelo menos uma pergunta.');
                return;
            }

            provas.push({
                id: provas.length + 1,
                titulo,
                perguntas: perguntasTemp
            });

            salvarDados();
            perguntasTemp = [];
            document.getElementById('novaProvaForm').reset();
            atualizarListaPerguntas();
            const perguntaModal = bootstrap.Modal.getInstance(document.getElementById('novaPerguntaModal'));
            const provaModal = bootstrap.Modal.getInstance(document.getElementById('novaProvaModal'));
            perguntaModal.hide();
            provaModal.hide();
            document.getElementById('sucessoTexto').textContent = 'Prova enviada!';
            new bootstrap.Modal(document.getElementById('sucessoModal')).show();
            atualizarProvas();
        }

        function atualizarListaPerguntas() {
            const lista = document.getElementById('perguntasLista');
            lista.innerHTML = perguntasTemp.length ? `
                <h6>Perguntas Adicionadas:</h6>
                <ul class="list-group">
                    ${perguntasTemp.map((p, i) => `
                        <li class="list-group-item">Pergunta ${i + 1}: ${p.texto}</li>
                    `).join('')}
                </ul>
            ` : '<p class="text-muted">Nenhuma pergunta adicionada.</p>';
        }

        document.getElementById('novaProvaModal').addEventListener('show.bs.modal', () => {
            perguntasTemp = [];
            document.getElementById('novaPerguntaModalLabel').textContent = 'Pergunta 1';
            atualizarListaPerguntas();
            document.getElementById('novaProvaForm').reset();
        });

        document.getElementById('novaProvaForm').addEventListener('submit', (e) => {
            e.preventDefault();
            enviarProva();
        });

        document.getElementById('sucessoOkButton').addEventListener('click', () => {
            bootstrap.Modal.getInstance(document.getElementById('sucessoModal')).hide();
        });

        function atualizarProvas() {
            const listaProvas = document.getElementById('listaProvas');
            listaProvas.innerHTML = '';
            provas.forEach(prova => {
                const li = document.createElement('li');
                li.className = 'list-group-item d-flex justify-content-between align-items-center';
                let nota = '';
                let isConcluida = false;
                if (!usuarioLogado.isAdmin && respostas[usuarioLogado.username]?.[prova.id]) {
                    nota = `<span class="badge bg-success">Nota: ${respostas[usuarioLogado.username][prova.id].pontuacao}</span>`;
                    isConcluida = true;
                }
                li.innerHTML = `
                    <span>${prova.titulo}</span>
                    <div>
                        ${nota}
                        ${usuarioLogado.isAdmin ? `<button class="btn btn-danger btn-sm ms-2" onclick="confirmarExclusaoProva(${prova.id}, '${prova.titulo}')">Excluir</button>` : ''}
                    </div>
                `;
                if (!isConcluida && !usuarioLogado.isAdmin) {
                    li.style.cursor = 'pointer';
                    li.addEventListener('click', () => abrirProva(prova));
                }
                listaProvas.appendChild(li);
            });
        }

        function confirmarExclusaoProva(provaId, titulo) {
            document.getElementById('tituloProvaExclusao').textContent = titulo;
            const modal = new bootstrap.Modal(document.getElementById('confirmacaoExclusaoProvaModal'));
            document.getElementById('confirmarExclusaoProvaBtn').onclick = () => {
                provas = provas.filter(p => p.id !== provaId);
                Object.keys(respostas).forEach(username => {
                    delete respostas[username][provaId];
                });
                salvarDados();
                atualizarProvas();
                modal.hide();
                document.getElementById('sucessoTexto').textContent = 'Prova excluída!';
                new bootstrap.Modal(document.getElementById('sucessoModal')).show();
            };
            modal.show();
        }

        function abrirProva(prova) {
            if (usuarioLogado.isAdmin || respostas[usuarioLogado.username]?.[prova.id]) return;
            const modal = new bootstrap.Modal(document.getElementById('provaModal'));
            document.getElementById('provaModalLabel').textContent = prova.titulo;
            const container = document.getElementById('perguntaContainer');
            const btnAnterior = document.getElementById('btnAnterior');
            const btnProxima = document.getElementById('btnProxima');
            const btnEnviar = document.getElementById('btnEnviar');
            let currentIndex = 0;
            const respostasTemp = {};

            function renderizarPergunta(index) {
                const p = prova.perguntas[index];
                container.innerHTML = `
                    <div class="question">
                        <p>${index + 1}. ${p.texto}</p>
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="q${index}" value="a" id="q${index}a" ${respostasTemp[index] === 'a' ? 'checked' : ''} required>
                            <label class="form-check-label" for="q${index}a">${p.opcoes.a}</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="q${index}" value="b" id="q${index}b" ${respostasTemp[index] === 'b' ? 'checked' : ''} required>
                            <label class="form-check-label" for="q${index}b">${p.opcoes.b}</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="q${index}" value="c" id="q${index}c" ${respostasTemp[index] === 'c' ? 'checked' : ''} required>
                            <label class="form-check-label" for="q${index}c">${p.opcoes.c}</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="q${index}" value="d" id="q${index}d" ${respostasTemp[index] === 'd' ? 'checked' : ''} required>
                            <label class="form-check-label" for="q${index}d">${p.opcoes.d}</label>
                        </div>
                    </div>
                `;
                btnAnterior.classList.toggle('hidden', index === 0);
                btnProxima.classList.toggle('hidden', index === prova.perguntas.length - 1);
                btnEnviar.classList.toggle('hidden', index !== prova.perguntas.length - 1);
            }

            function salvarResposta(index) {
                const resposta = document.querySelector(`input[name="q${index}"]:checked`);
                if (resposta) {
                    respostasTemp[index] = resposta.value;
                }
            }

            renderizarPergunta(currentIndex);

            btnProxima.addEventListener('click', () => {
                salvarResposta(currentIndex);
                currentIndex++;
                renderizarPergunta(currentIndex);
            });

            btnAnterior.addEventListener('click', () => {
                salvarResposta(currentIndex);
                currentIndex--;
                renderizarPergunta(currentIndex);
            });

            btnEnviar.addEventListener('click', () => {
                salvarResposta(currentIndex);
                const confirmModal = new bootstrap.Modal(document.getElementById('confirmacaoEnvioModal'));
                confirmModal.show();
                document.getElementById('confirmarEnvioBtn').onclick = () => {
                    let pontuacao = 0;
                    prova.perguntas.forEach((p, i) => {
                        if (respostasTemp[i] === p.correta) pontuacao += 50;
                    });
                    if (!respostas[usuarioLogado.username]) respostas[usuarioLogado.username] = {};
                    respostas[usuarioLogado.username][prova.id] = { pontuacao };
                    const usuario = usuarios.find(u => u.username === usuarioLogado.username);
                    usuario.pontos += pontuacao;
                    salvarDados();
                    confirmModal.hide();
                    modal.hide();
                    document.getElementById('resultadoTexto').textContent = `Pontuação: ${pontuacao} pontos!`;
                    new bootstrap.Modal(document.getElementById('resultadoModal')).show();
                    atualizarProvas();
                    atualizarRanking();
                    inicializarGrafico();
                };
            });

            modal.show();
        }

        function atualizarRanking() {
            const rankingBody = document.getElementById('rankingBody');
            rankingBody.innerHTML = '';
            const ordenados = [...usuarios].sort((a, b) => b.pontos - a.pontos);
            ordenados.forEach((u, i) => {
                if (!u.isAdmin) {
                    rankingBody.innerHTML += `
                        <tr>
                            <td>${i + 1}</td>
                            <td>${u.nome}</td>
                            <td>${u.pontos}</td>
                            <td>${usuarioLogado.isAdmin ? `<button class="btn btn-danger btn-sm" onclick="confirmarExclusaoUsuario('${u.username}')">Remover</button>` : ''}</td>
                        </tr>
                    `;
                }
            });
        }

        function confirmarExclusaoUsuario(username) {
            const usuario = usuarios.find(u => u.username === username);
            document.getElementById('nomeUsuarioExclusao').textContent = usuario.nome;
            const modal = new bootstrap.Modal(document.getElementById('confirmacaoExclusaoModal'));
            document.getElementById('confirmarExclusaoBtn').onclick = () => {
                usuarios = usuarios.filter(u => u.username !== username);
                delete respostas[username];
                comprovantes = comprovantes.filter(c => c.username !== username);
                feeds = feeds.map(f => ({
                    ...f,
                    curtidas: f.curtidas.filter(u => u !== username),
                    comentarios: f.comentarios.map(c => ({
                        ...c,
                        autor: c.autor === username ? '[Removido]' : c.autor,
                        curtidas: c.curtidas.filter(u => u !== username),
                        respostas: c.respostas.map(r => ({
                            ...r,
                            autor: r.autor === username ? '[Removido]' : r.autor
                        }))
                    }))
                }));
                salvarDados();
                atualizarRanking();
                atualizarInvestimentos();
                atualizarFeed();
                modal.hide();
                document.getElementById('sucessoTexto').textContent = 'Usuário removido!';
                new bootstrap.Modal(document.getElementById('sucessoModal')).show();
            };
            modal.show();
        }

        document.getElementById('novoUsuarioForm').addEventListener('submit', (e) => {
            e.preventDefault();
            const username = document.getElementById('novoUsername').value.trim();
            const password = document.getElementById('novoPassword').value.trim();
            const nome = document.getElementById('nomeUsuario').value.trim();
            if (usuarios.find(u => u.username === username)) return;
            usuarios.push({ username, password, nome, isAdmin: false, pontos: 0 });
            salvarDados();
            document.getElementById('novoUsuarioForm').reset();
            atualizarRanking();
        });

        document.getElementById('comprovanteForm').addEventListener('submit', (e) => {
            e.preventDefault();
            const arquivo = document.getElementById('comprovanteArquivo').files[0];
            if (!arquivo || !['.jpg', '.jpeg', '.png', '.pdf'].includes(arquivo.name.substring(arquivo.name.lastIndexOf('.')).toLowerCase())) return;
            comprovantes.push({
                id: comprovantes.length + 1,
                username: usuarioLogado.username,
                nome: usuarioLogado.nome,
                data: new Date().toLocaleString('pt-BR'),
                arquivo: arquivo.name,
                verificado: false
            });
            salvarDados();
            document.getElementById('comprovanteForm').reset();
            document.getElementById('comprovanteSuccess').style.display = 'block';
            setTimeout(() => document.getElementById('comprovanteSuccess').style.display = 'none', 3000);
            atualizarInvestimentos();
        });

        function atualizarInvestimentos() {
            const body = document.getElementById('investimentosBody');
            body.innerHTML = comprovantes.length ? comprovantes.map(c => `
                <tr>
                    <td>${c.nome}</td>
                    <td>${c.data}</td>
                    <td>${c.verificado ? '<span class="badge bg-success">Verificado</span>' : '<span class="badge bg-warning">Pendente</span>'}</td>
                    <td><button class="btn btn-primary btn-sm" onclick="visualizarComprovante(${c.id})">Visualizar</button></td>
                </tr>
            `).join('') : '<tr><td colspan="4" class="text-center">Nenhum comprovante</td></tr>';
        }

        function visualizarComprovante(id) {
            const c = comprovantes.find(c => c.id === id);
            document.getElementById('comprovanteModalLabel').textContent = `Comprovante de ${c.nome}`;
            document.getElementById('comprovanteInfo').innerHTML = `
                <p><strong>Usuário:</strong> ${c.nome}</p>
                <p><strong>Data:</strong> ${c.data}</p>
                <p><strong>Arquivo:</strong> ${c.arquivo}</p>
            `;
            document.getElementById('comprovanteVisualizacao').innerHTML = `<p>Visualização: ${c.arquivo} (Simulação)</p>`;
            document.getElementById('verificarComprovanteBtn').disabled = c.verificado;
            document.getElementById('verificarComprovanteBtn').onclick = () => {
                c.verificado = true;
                salvarDados();
                atualizarInvestimentos();
                bootstrap.Modal.getInstance(document.getElementById('comprovanteModal')).hide();
                document.getElementById('sucessoTexto').textContent = 'Comprovante verificado!';
                new bootstrap.Modal(document.getElementById('sucessoModal')).show();
            };
            new bootstrap.Modal(document.getElementById('comprovanteModal')).show();
        }

        function configurarFeed() {
            const feedForm = document.getElementById('feedForm');
            const feedFormContainer = document.getElementById('feedFormContainer');

            if (!feedForm || !feedFormContainer) {
                console.error('Elementos feedForm ou feedFormContainer não encontrados');
                return;
            }

            if (usuarioLogado.isAdmin) {
                feedFormContainer.classList.remove('hidden');
            } else {
                feedFormContainer.classList.add('hidden');
            }

            feedForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const mensagem = document.getElementById('feedMessage').value.trim();
                const successMessage = document.getElementById('feedSuccess');
                const errorMessage = document.getElementById('feedError');

                if (!mensagem) {
                    errorMessage.style.display = 'block';
                    setTimeout(() => errorMessage.style.display = 'none', 3000);
                    return;
                }

                if (!usuarioLogado.isAdmin) return;

                feeds.unshift({
                    id: feeds.length + 1,
                    autor: usuarioLogado.nome,
                    mensagem,
                    data: new Date().toLocaleString('pt-BR'),
                    curtidas: [],
                    comentarios: []
                });

                salvarDados();
                feedForm.reset();
                successMessage.style.display = 'block';
                setTimeout(() => successMessage.style.display = 'none', 3000);
                atualizarFeed();
            });

            atualizarFeed();
        }

        function atualizarFeed() {
            const container = document.getElementById('feedContainer');
            container.innerHTML = feeds.length ? feeds.map(f => `
                <div class="feed-post">
                    <div class="feed-post-header">
                        <div>
                            <h5>${f.autor}</h5>
                            <small>${f.data}</small>
                        </div>
                        ${usuarioLogado.isAdmin ? `
                            <div class="feed-post-menu">
                                <button class="feed-post-menu-btn" onclick="toggleMenu(${f.id})"><i class="fas fa-ellipsis-v"></i></button>
                                <div class="feed-post-menu-content" id="menu-${f.id}">
                                    <button onclick="excluirFeed(${f.id})">Excluir</button>
                                </div>
                            </div>
                        ` : ''}
                    </div>
                    <div class="feed-post-body">
                        <p>${f.mensagem}</p>
                    </div>
                    <div class="feed-actions">
                        <button class="feed-action-btn ${f.curtidas.includes(usuarioLogado.username) ? 'liked' : ''}" onclick="curtirFeed(${f.id})">
                            <i class="fas fa-heart"></i> <span>${f.curtidas.length}</span>
                        </button>
                        <button class="feed-action-btn" onclick="toggleCommentForm(${f.id})">
                            <i class="fas fa-comment"></i> <span>${f.comentarios.length}</span>
                        </button>
                    </div>
                    <div class="comment-section" id="comment-section-${f.id}">
                        <form class="comment-form hidden" id="comment-form-${f.id}" onsubmit="comentarFeed(event, ${f.id})">
                            <div class="d-flex gap-2">
                                <input type="text" class="form-control" placeholder="Escreva um comentário" required>
                                <button type="submit" class="btn btn-primary">Comentar</button>
                            </div>
                        </form>
                        <div class="comments">
                            ${f.comentarios.map((c, i) => `
                                <div class="comment">
                                    <div class="comment-header">
                                        <h6>${c.autor}</h6>
                                        <small>${c.data}</small>
                                    </div>
                                    <div class="comment-body">
                                        <p>${c.mensagem}</p>
                                    </div>
                                    <div class="comment-actions">
                                        <button class="feed-action-btn ${c.curtidas.includes(usuarioLogado.username) ? 'liked' : ''}" onclick="curtirComentario(${f.id}, ${i})">
                                            <i class="fas fa-heart"></i> <span>${c.curtidas.length}</span>
                                        </button>
                                        <button class="btn-reply" onclick="toggleReplyForm(${f.id}, ${i})">Responder</button>
                                    </div>
                                    <form class="reply-form hidden" id="reply-form-${f.id}-${i}" onsubmit="responderComentario(event, ${f.id}, ${i})">
                                        <div class="d-flex gap-2">
                                            <input type="text" class="form-control" placeholder="Escreva uma resposta" required>
                                            <button type="submit" class="btn btn-primary">Responder</button>
                                        </div>
                                    </form>
                                    <div class="replies">
                                        ${c.respostas.map(r => `
                                            <div class="comment">
                                                <div class="comment-header">
                                                    <h6>${r.autor}</h6>
                                                    <small>${r.data}</small>
                                                </div>
                                                <div class="comment-body">
                                                    <p>${r.mensagem}</p>
                                                </div>
                                            </div>
                                        `).join('')}
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                </div>
            `).join('') : '<p class="text-muted">Nenhum recado no feed.</p>';
        }

        function toggleMenu(feedId) {
            const menu = document.getElementById(`menu-${feedId}`);
            menu.classList.toggle('show');
        }

        function excluirFeed(feedId) {
            feeds = feeds.filter(f => f.id !== feedId);
            salvarDados();
            atualizarFeed();
        }

        function curtirFeed(feedId) {
            const feed = feeds.find(f => f.id === feedId);
            if (!feed.curtidas.includes(usuarioLogado.username)) {
                feed.curtidas.push(usuarioLogado.username);
            } else {
                feed.curtidas = feed.curtidas.filter(u => u !== usuarioLogado.username);
            }
            salvarDados();
            atualizarFeed();
        }

        function toggleCommentForm(feedId) {
            const form = document.getElementById(`comment-form-${feedId}`);
            form.classList.toggle('hidden');
        }

        function comentarFeed(event, feedId) {
            event.preventDefault();
            const input = event.target.querySelector('input');
            const mensagem = input.value.trim();
            if (!mensagem) return;

            const feed = feeds.find(f => f.id === feedId);
            feed.comentarios.push({
                autor: usuarioLogado.nome,
                mensagem,
                data: new Date().toLocaleString('pt-BR'),
                curtidas: [],
                respostas: []
            });

            salvarDados();
            input.value = '';
            atualizarFeed();
        }

        function curtirComentario(feedId, comentarioIndex) {
            const feed = feeds.find(f => f.id === feedId);
            const comentario = feed.comentarios[comentarioIndex];
            if (!comentario.curtidas.includes(usuarioLogado.username)) {
                comentario.curtidas.push(usuarioLogado.username);
            } else {
                comentario.curtidas = comentario.curtidas.filter(u => u !== usuarioLogado.username);
            }
            salvarDados();
            atualizarFeed();
        }

        function toggleReplyForm(feedId, comentarioIndex) {
            const form = document.getElementById(`reply-form-${feedId}-${comentarioIndex}`);
            form.classList.toggle('hidden');
        }

        function responderComentario(event, feedId, comentarioIndex) {
            event.preventDefault();
            const input = event.target.querySelector('input');
            const mensagem = input.value.trim();
            if (!mensagem) return;

            const feed = feeds.find(f => f.id === feedId);
            feed.comentarios[comentarioIndex].respostas.push({
                autor: usuarioLogado.nome,
                mensagem,
                data: new Date().toLocaleString('pt-BR')
            });

            salvarDados();
            input.value = '';
            atualizarFeed();
        }

        document.addEventListener('click', (e) => {
            if (!e.target.closest('.feed-post-menu-btn') && !e.target.closest('.feed-post-menu-content')) {
                document.querySelectorAll('.feed-post-menu-content.show').forEach(menu => {
                    menu.classList.remove('show');
                });
            }
        });
    </script>
</body>
</html>
